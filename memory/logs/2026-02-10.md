# 2026-02-10

## Cron Scheduler Bug - Diagnosed & Fixed

**Problem discovered:** OpenClaw's internal cron scheduler wasn't firing recurring jobs. Timer never triggered despite correct nextWakeAtMs values.

**Investigation:**
- Jobs stored correctly in `~/.openclaw/cron/jobs.json`
- Manual `openclaw cron run` worked fine
- Gateway logs showed no wake events at scheduled times
- Updated to v2026.2.9 — didn't fix it
- Restarted gateway — didn't fix it

**Solution implemented - Hybrid Approach:**

### 1. launchd for exact-time tasks (macOS native scheduler)
Created plist files in `~/Library/LaunchAgents/`:
- `com.openclaw.blog-writer.plist` — Daily 2 AM
- `com.openclaw.weekly-improvement.plist` — Sunday 3 AM
- `com.openclaw.update-check.plist` — Monday 9 AM

Each calls `openclaw cron run <jobId>` at the scheduled time.

### 2. HEARTBEAT.md for periodic checks
Moved TechMeme digest and maintenance tasks to heartbeat (runs every 1h).
Created `memory/heartbeat-state.json` for tracking last check times.

### 3. Kept OpenClaw cron jobs
Jobs still exist in OpenClaw (contain the actual task logic).
launchd triggers them; OpenClaw executes them.

**Files updated:**
- TOOLS.md — Added scheduling section with best practices
- MEMORY.md — Added lesson learned
- HEARTBEAT.md — Added periodic check tasks
- memory/heartbeat-state.json — Created for state tracking

**Rule for future scheduling:**
- Flexible timing → HEARTBEAT.md
- Exact timing → launchd + OpenClaw cron job
- One-shot → OpenClaw cron `--at` (works fine)
